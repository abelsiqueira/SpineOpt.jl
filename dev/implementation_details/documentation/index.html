<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Documentation · SpineOpt.jl</title><meta name="title" content="Documentation · SpineOpt.jl"/><meta property="og:title" content="Documentation · SpineOpt.jl"/><meta property="twitter:title" content="Documentation · SpineOpt.jl"/><meta name="description" content="Documentation for SpineOpt.jl."/><meta property="og:description" content="Documentation for SpineOpt.jl."/><meta property="twitter:description" content="Documentation for SpineOpt.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SpineOpt.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/setup_workflow/">Setting up a workflow</a></li><li><a class="tocitem" href="../../getting_started/creating_your_own_model/">Creating Your Own Model</a></li><li><a class="tocitem" href="../../getting_started/archetypes/">Archetypes</a></li><li><a class="tocitem" href="../../getting_started/output_data/">Managing Outputs</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorial/webinars/">Webinars</a></li><li><a class="tocitem" href="../../tutorial/simple_system/">Simple system</a></li><li><a class="tocitem" href="../../tutorial/tutorialTwoHydro/">Two hydro plants</a></li><li><a class="tocitem" href="../../tutorial/case_study_a5/">Case Study A5</a></li></ul></li><li><span class="tocitem">How to</span><ul><li><a class="tocitem" href="../../how_to/change_the_solver/">Change the solver</a></li><li><a class="tocitem" href="../../how_to/define_an_efficiency/">Define an efficiency</a></li><li><a class="tocitem" href="../../how_to/print_the_model/">Print the model</a></li></ul></li><li><span class="tocitem">Concept Reference</span><ul><li><a class="tocitem" href="../../concept_reference/the_basics/">Basics of the model structure</a></li><li><a class="tocitem" href="../../concept_reference/Object Classes/">Object Classes</a></li><li><a class="tocitem" href="../../concept_reference/Relationship Classes/">Relationship Classes</a></li><li><a class="tocitem" href="../../concept_reference/Parameters/">Parameters</a></li><li><a class="tocitem" href="../../concept_reference/Parameter Value Lists/">Parameter Value Lists</a></li></ul></li><li><span class="tocitem">Mathematical Formulation</span><ul><li><a class="tocitem" href="../../mathematical_formulation/variables/">Variables</a></li><li><a class="tocitem" href="../../mathematical_formulation/constraints_automatically_generated_file/">Constraints</a></li><li><a class="tocitem" href="../../mathematical_formulation/objective_function/">Objective</a></li></ul></li><li><span class="tocitem">Advanced Concepts</span><ul><li><a class="tocitem" href="../../advanced_concepts/temporal_framework/">Temporal Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/stochastic_framework/">Stochastic Framework</a></li><li><a class="tocitem" href="../../advanced_concepts/unit_commitment/">Unit Commitment</a></li><li><a class="tocitem" href="../../advanced_concepts/ramping_and_reserves/">Ramping and Reserves</a></li><li><a class="tocitem" href="../../advanced_concepts/investment_optimization/">Investment Optimization</a></li><li><a class="tocitem" href="../../advanced_concepts/user_constraints/">User Constraints</a></li><li><a class="tocitem" href="../../advanced_concepts/decomposition/">Decomposition</a></li><li><a class="tocitem" href="../../advanced_concepts/powerflow/">PTDF-Based Powerflow</a></li><li><a class="tocitem" href="../../advanced_concepts/pressure_driven_gas_transfer/">Pressure driven gas transfer</a></li><li><a class="tocitem" href="../../advanced_concepts/Lossless_DC_power_flow/">Lossless nodal DC power flows</a></li><li><a class="tocitem" href="../../advanced_concepts/representative_days_w_seasonal_storage/">Representative days with seasonal storages</a></li><li><a class="tocitem" href="../../advanced_concepts/cumulated_flow_restrictions/">Imposing renewable energy targets</a></li><li><a class="tocitem" href="../../advanced_concepts/mga/">Modelling to generate alternatives</a></li></ul></li><li><span class="tocitem">Implementation details</span><ul><li class="is-active"><a class="tocitem" href>Documentation</a><ul class="internal"><li><a class="tocitem" href="#Concept-reference"><span>Concept reference</span></a></li><li><a class="tocitem" href="#Documentation-from-docstring"><span>Documentation from docstring</span></a></li><li><a class="tocitem" href="#Drag-and-drop"><span>Drag and drop</span></a></li></ul></li><li><a class="tocitem" href="../how_does_the_model_update_itself/">How does the model update itself</a></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Implementation details</a></li><li class="is-active"><a href>Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/spine-tools/SpineOpt.jl/blob/master/docs/src/implementation_details/documentation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h1><p>The documentation is mostly build with regular <a href="https://documenter.juliadocs.org/stable/">Documenter.jl</a>. <code>make.jl</code> is therefore the main file for building the documentation. However, there are a few convenience functions which automate some parts of the process. Some of these are located close to the documentation (e.g. SPINEOPT.jl/docs/src/mathematical_formulation/write_documentation_sets_and_variables.jl) while other functions are inherently part of the SpineOpt code (e.g. SPINEOPT.jl/src/util/docs_util.jl).</p><h2 id="Concept-reference"><a class="docs-heading-anchor" href="#Concept-reference">Concept reference</a><a id="Concept-reference-1"></a><a class="docs-heading-anchor-permalink" href="#Concept-reference" title="Permalink"></a></h2><p>Parameters.md is one of the files that is automatically generated. Each parameter has a description in the concept_reference folder and is further processed with the spineopt template. As such there is no point in attempting to make changes directly in Parameters.md.</p><h2 id="Documentation-from-docstring"><a class="docs-heading-anchor" href="#Documentation-from-docstring">Documentation from docstring</a><a id="Documentation-from-docstring-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation-from-docstring" title="Permalink"></a></h2><p>The mathematical formulation of the constraints is also automatically generated: constraints.md contains the list of instructions to automatically pull text from docstrings to the file constraints_automatically_generated_file.md. An example of an instruction:</p><pre><code class="nohighlight hljs">### Nodal balance
#region instruction
add_constraint_nodal_balance!
description
formulation
#endregion instruction</code></pre><p>Anything within <code>#region instruction</code> and <code>#endregion instruction</code> will be interpreted as an instruction. Anything outside that structure will be interpreted as regular markdown text to be copied directly to the file (e.g. <code>### Nodal balance</code>). The first line of the instruction is the function from which you want to pull the docstring. The other arguments are the fields in the docstring that you want to include.</p><p>The current list of fields for constraints:</p><ul><li>description: describes the formulation of the constraint in words</li><li>formulation: describes the formulation of the constraints in latex formulas</li></ul><p>There is also a special instruction specifically for getting the same field (or fields) from all constraint functions; instead of specifying the function name you can write <code>alldocstrings</code>. It will also automatically generate titles in between corresponding to the constraint.</p><p>An example for how the docstring looks:</p><pre><code class="nohighlight hljs">@doc raw&quot;&quot;&quot;
    add_constraint_nodal_balance!(m::Model)

Balance equation for nodes.

    #region description
    In **SpineOpt**, [node](@ref) is the place where an energy balance is enforced. As universal aggregators,
    they are the glue that brings all components of the energy system together. An energy balance is created for each [node](@ref) for all `node_stochastic_time_indices`, unless the [balance\_type](@ref) parameter of the node takes the value [balance\_type\_none](@ref balance_type_list) or if the node in question is a member of a node group, for which the [balance\_type](@ref) is [balance\_type\_group](@ref balance_type_list). The parameter [nodal\_balance\_sense](@ref) defaults to equality, but can be changed to allow overproduction ([nodal\_balance\_sense](@ref) [`&gt;=`](@ref constraint_sense_list)) or underproduction ([nodal\_balance\_sense](@ref) [`&lt;=`](@ref constraint_sense_list)).
    The energy balance is enforced by the following constraint:
    #endregion description

    #region formulation
    ```math
    \begin{aligned}
    &amp; v_{node\_injection}(n,s,t) \\
    &amp; + \sum_{\substack{(conn,n&#39;,d_{in},s,t) \in connection\_flow\_indices: \\ d_{out} == :to\_node}}
    v_{connection\_flow}(conn,n&#39;,d_{in},s,t)\\
    &amp; - \sum_{\substack{(conn,n&#39;,d_{out},s,t) \in connection\_flow\_indices: \\ d_{out} == :from\_node}}
    v_{connection\_flow}(conn,n&#39;,d_{out},s,t)\\
    &amp; + v_{node\_slack\_pos}(n,s,t) \\
    &amp; - v_{node\_slack\_neg}(n,s,t) \\
    &amp; \{&gt;=,==,&lt;=\} \\
    &amp; 0 \\
    &amp; \forall (n,s,t) \in node\_stochastic\_time\_indices: \\
    &amp; p_{balance\_type}(n) != balance\_type\_none \\
    &amp; \nexists ng \in groups(n) : balance\_type\_group \\
    \end{aligned}
    ```
    #endregion formulation
&quot;&quot;&quot;</code></pre><p>The reason for using the docstring is such that it is easier to update the documentation in the docstring when developing a certain constraint.</p><p>The feature is completely optional. To activate the functionality for another file (e.g. objective) add the code similar to this to make.jl, make the instruction file and point to the generated file.</p><pre><code class="language-julia hljs">mathpath = joinpath(path, &quot;src&quot;, &quot;mathematical_formulation&quot;)
alldocs = SpineOpt.alldocstrings(SpineOpt)
instructionlist = readlines(joinpath(mathpath, &quot;constraints.md&quot;))
markdownstring = SpineOpt.docs_from_instructionlist(alldocs, instructionlist)
open(joinpath(mathpath, &quot;constraints_automatically_generated_file.md&quot;), &quot;w&quot;) do file
    write(file, markdownstring)
end
instructionlist = readlines(joinpath(mathpath, &quot;objective_function.md&quot;))
markdownstring = SpineOpt.docs_from_instructionlist(alldocs, instructionlist)
open(joinpath(mathpath, &quot;objective_function_automatically_generated_file.md&quot;), &quot;w&quot;) do file
    write(file, markdownstring)
end</code></pre><p>To deactivate the functionality, remove the code and rename the generated file (such that it is clearer that you now need to change things manually again).</p><p>It is also possible to introduce this feature over time. Anytime you want to add the documentation of a constraint to the docstring you need to follow a few steps:</p><ol><li>For the docstring<ol><li>add <code>@doc raw</code> before the docstring (that allows to copy paste the latex already in the current documentation)</li><li>add the necessary fields somewhere in the docstring, e.g. <code>#region formulation</code> and <code>#endregion formulation</code> on different lines</li></ol></li><li>For the instructionfile<ol><li>cut the description and formulation and paste it in the fields of the docstring</li><li>write the instruction to point to the correct function and corresponding fields</li></ol></li></ol><p>An example of both the docstring and the instructionfile have already been shown above.</p><h2 id="Drag-and-drop"><a class="docs-heading-anchor" href="#Drag-and-drop">Drag and drop</a><a id="Drag-and-drop-1"></a><a class="docs-heading-anchor-permalink" href="#Drag-and-drop" title="Permalink"></a></h2><p>There is also a drag-and-drop feature for select chapters (e.g. the how to section). For those chapters you can simply add your markdown file to the folder of the chapter and it will be automatically added to the documentation. To allow both manually composed chapters and automatically generated chapter, the functionality is only activated for empty chapters (of the structure &quot;chapter name&quot; =&gt; []).</p><p>The drag-and-drop function assumes a specific structure for the documentation files.</p><ul><li>All chapters and corresponding markdownfiles are in the docs/src folder.</li><li>Folder names need to be lowercase with underscores because the automated folder names are derived from the page names in make.jl. A new chapter (e.g. implementation details) needs to follow this structure.</li><li>Markdown file names can have uppercases and can have underscores but don&#39;t need to because the page names in make.jl are derived from the actual file names. In other words, your filename will become the page name in the documentation so make this descriptive.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../advanced_concepts/mga/">« Modelling to generate alternatives</a><a class="docs-footer-nextpage" href="../how_does_the_model_update_itself/">How does the model update itself »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 3 November 2023 07:23">Friday 3 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
